import{loadFragment}from"../fragment/fragment.js";import{buildBlock,decorateBlock,loadBlock,loadCSS}from"../../scripts/aem.js";async function createModal(e){await loadCSS(window.hlx.codeBasePath+"/blocks/modal/modal.css");let d=document.createElement("dialog"),o=document.createElement("div");o.classList.add("modal-content"),o.append(...e),d.append(o);e=document.createElement("button");e.classList.add("close-button"),e.setAttribute("aria-label","Close"),e.type="button",e.innerHTML='<span class="icon icon-close"></span>',e.addEventListener("click",()=>d.close()),d.prepend(e);let t=buildBlock("modal","");return document.querySelector("main").append(t),decorateBlock(t),await loadBlock(t),d.addEventListener("click",e=>{var{left:o,right:t,top:a,bottom:l}=d.getBoundingClientRect(),{clientX:e,clientY:n}=e;(e<o||t<e||n<a||l<n)&&d.close()}),d.addEventListener("close",()=>{document.body.classList.remove("modal-open"),t.remove()}),t.innerHTML="",t.append(d),{block:t,showModal:()=>{d.showModal(),setTimeout(()=>{o.scrollTop=0},0),document.body.classList.add("modal-open")}}}async function openModal(e){e=e.startsWith("http")?new URL(e,window.location).pathname:e,e=(await createModal((await loadFragment(e)).childNodes)).showModal;e()}export{createModal,openModal};